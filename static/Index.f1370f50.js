import"./vue.c1672130.js";import{u as m,w as z,r as I}from"./xlsx.520f6e06.js";import{V as N,g as U}from"./Index.fd0194a6.js";import{b as B}from"./element-plus.4f823412.js";import{d as V,aE as j,e as F,a6 as E,o as k,c as M,Z as n,S as o,a as P,u as O,R as S,W as T,X as c}from"./@vue.09569551.js";import{_ as R}from"./index.eaf6131b.js";import"./lodash-es.dc961dbb.js";import"./@vueuse.b65f177f.js";import"./@element-plus.7e1bc788.js";import"./@popperjs.1b99db09.js";import"./@ctrl.9835af1a.js";import"./dayjs.6f64b8ed.js";import"./@amap.355e2153.js";import"./async-validator.7d7c1b66.js";import"./memoize-one.af833c6f.js";import"./escape-html.540651be.js";import"./normalize-wheel-es.322481fb.js";import"./@floating-ui.338bbb63.js";import"./pinia.883ae6ad.js";import"./chroma-js.74ccae7c.js";import"./axios.1b92673f.js";import"./nprogress.f2ef1f3b.js";import"./vue-router.c7420244.js";import"./@iconify.69a8b4f7.js";import"./vite-plugin-mock.aff57788.js";import"./mockjs.9dfcd39d.js";import"./path-to-regexp.17960349.js";const H=(d,u)=>{const l=new FileReader;l.readAsBinaryString(d),l.onload=u},K=(d,u,l="excel.xlsx",p="Sheet1")=>{const _=m.json_to_sheet(d);m.sheet_add_aoa(_,[u]);const s=m.book_new();m.book_append_sheet(s,_,p),z(s,l)},$={class:"excel-handle"},L={class:"v-flex aic header"},X=c("\u5BFC\u5165\u8868\u683C\u6570\u636E"),Z=c("\u5BFC\u51FAExcel\u6587\u4EF6"),q=c("\u6B63\u5E38"),G=c("\u7981\u7528"),J=c("\u4FEE\u6539"),Q=c("\u5220\u9664"),Y=V({__name:"Index",async setup(d){let u,l;const p=[{columnTitle:"\u65E5\u671F",columnWidth:120,columnProp:"date"},{columnTitle:"\u7528\u6237\u540D",columnWidth:100,columnProp:"name"},{columnTitle:"\u5BB6\u5EAD\u4F4F\u5740",columnProp:"address"},{columnTitle:"\u72B6\u6001",columnProp:"status",columnCustom:!0,columnWidth:80},{columnTitle:"\u64CD\u4F5C",columnProp:"operation",columnCustom:!0,columnFixed:"right"}],{data:_}=([u,l]=j(()=>U()),u=await u,l(),u),s=F(_)||[],w=i=>{B.alert("\u662F\u5426\u4FEE\u6539\u6570\u636E","\u4FEE\u6539\u6570\u636E",{confirmButtonText:"OK",callback:t=>{console.log(t,i)}})},D=i=>{B.alert("\u662F\u5426\u5220\u9664\u6570\u636E","\u5220\u9664\u6570\u636E",{confirmButtonText:"OK",callback:t=>{console.log(t,i)}})},v=F(1),g=F(15),C=F([]),A=i=>{H(i.raw,t=>{var f;const a=I((f=t.target)==null?void 0:f.result,{type:"binary"}),h=a.SheetNames[0];let r=m.sheet_to_json(a.Sheets[h]);r=r.map(e=>{const x={};for(const y in e)p.some(b=>b.columnTitle===y?(x[b.columnProp]=e[y],!0):!1);return x}),s.value=r})},W=()=>{K(s.value,["\u65E5\u671F","\u7528\u6237\u540D","\u5BB6\u5EAD\u4F4F\u5740","\u72B6\u6001"],"\u5458\u5DE5\u4FE1\u606F\u8868.xlsx","\u5458\u5DE5")};return(i,t)=>{const a=E("el-button"),h=E("el-upload"),r=E("el-tag"),f=E("el-card");return k(),M("div",$,[n(f,null,{default:o(()=>[P("section",L,[n(h,{"show-file-list":!1,"auto-upload":!1,"file-list":C.value,"onUpdate:file-list":t[0]||(t[0]=e=>C.value=e),multiple:!1,accept:".xls,.xlsx",onChange:A},{default:o(()=>[n(a,{type:"primary"},{default:o(()=>[X]),_:1})]),_:1},8,["file-list"]),n(a,{type:"info",onClick:W},{default:o(()=>[Z]),_:1})]),P("section",null,[n(N,{"table-header":p,"table-content":O(s),"is-need-checkbox":!0,defaultPage:v.value,"onUpdate:defaultPage":t[1]||(t[1]=e=>v.value=e),defaultPageSize:g.value,"onUpdate:defaultPageSize":t[2]||(t[2]=e=>g.value=e)},{status:o(({content:e})=>[e.status===1?(k(),S(r,{key:0},{default:o(()=>[q]),_:1})):T("v-if",!0),e.status===0?(k(),S(r,{key:1,type:"warning"},{default:o(()=>[G]),_:1})):T("v-if",!0)]),operation:o(({content:e})=>[n(a,{type:"primary",size:"small",onClick:x=>w(e)},{default:o(()=>[J]),_:2},1032,["onClick"]),n(a,{type:"danger",size:"small",onClick:x=>D(e)},{default:o(()=>[Q]),_:2},1032,["onClick"])]),_:1},8,["table-content","defaultPage","defaultPageSize"])])]),_:1})])}}});const Pe=R(Y,[["__scopeId","data-v-7f34f4c6"],["__file","/home/runner/work/vue-vite-ts-admin/vue-vite-ts-admin/src/views/Plugins/ExcelHandle/Index.vue"]]);export{Pe as default};
